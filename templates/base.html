<!DOCTYPE html>
<html>

<head>
    <title>{% block title %}–ü–∞–ª–∞–Ω—Ç–∏—Ä{% endblock %}</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/uikit.css') }}" />
    <script src="{{ url_for('static', filename='js/uikit.js') }}"></script>
    <script src="{{ url_for('static', filename='js/uikit-icons.js') }}"></script>
</head>

<body>
    <header class="uk-section uk-section-secondary uk-section-xsmall">
        <nav class="uk-navbar-container uk-navbar-transparent" uk-navbar>
            <div class="uk-navbar-center">
                <ul class="uk-navbar-nav">
                    <li><a href="/"><span class="uk-icon uk-icon-image"
                                style="background-image: url({{url_for('static', filename='images/favicon.png')}})"></span></a>
                    </li>
                    {% if g.t %}<li><a href="{{ url_for('students.all') }}">–£—á–µ–Ω–∏–∫–∏</a></li>{% endif %}
                    {% if g.d %}<li><a href="{{ url_for('teachers.all') }}">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</a></li>{% endif %}
                    <li><a href="{{ url_for('departments.all')}}">–û—Ç–¥–µ–ª–µ–Ω–∏—è</a></li>
                    {% if g.s %}<li><a href="{{ url_for('students.ensembles_all') }}">–ö–æ–ª–ª–µ–∫—Ç–∏–≤—ã</a></li>{% endif %}
                    {% if g.s %}<li><a href="{{ url_for('events.all_events') }}">–°–æ–±—ã—Ç–∏—è</a></li>{% endif %}
                    <li><a href="#">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a>
                        <div uk-dropdown>
                            <ul class="uk-nav uk-dropdown-nav">
                                <li><a style="color: #333 !important"
                                        href="{{ url_for('settings.subjects_list') }}">–ü—Ä–µ–¥–º–µ—Ç—ã</a></li>
                                {% if g.s %}<li><a style="color: #333 !important"
                                        href="{{ url_for('exams.all') }}">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –∞—Ç—Ç–µ—Å—Ç–∞—Ü–∏–∏</a></li>{%
                                endif %}
                                <li><a style="color: #333 !important"
                                        href="{{ url_for('method.protocols_list') }}">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –∑–∞—Å–µ–¥–∞–Ω–∏–π</a></li>
                                <li><a style="color: #333 !important"
                                        href="{{ url_for('method.reports_list') }}">–û—Ç—á—ë—Ç—ã –º–µ—Ç–æ–¥–∏—Å—Ç–∞</a></li>
                                {% if g.s %}<li><a style="color: #333 !important"
                                        href="{{ url_for('settings.attest_list') }}">–í–∏–¥—ã –∞—Ç—Ç–µ—Å—Ç–∞—Ü–∏–∏</a></li>{% endif %}
                            </ul>
                        </div>
                    </li>
                    <li><a href="{{ url_for('settings.all') }}">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
                </ul>
            </div>
        </nav>
    </header>
    <main class="uk-section uk-section-medium">
        <div class="uk-container">
            {% block content %}
            –ö–∞–∂–µ—Ç—Å—è, –∫—Ç–æ-—Ç–æ –∑–∞–±—ã–ª –ø—Ä–æ –±–ª–æ–∫ <code>content</code> –≤ —à–∞–±–ª–æ–Ω–µ ü§î
            {% endblock %}
        </div>
        <div class="shutdown-section" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
            <button onclick="shutdownApplication()" class="uk-button uk-button-danger uk-button-small">
                <span uk-icon="icon: close"></span> –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É
            </button>
        </div>
    </main>
    <!-- –ü–æ–¥–≤–∞–ª -->
    <footer class="uk-section uk-section-secondary uk-section-xlarge">
        <div class="uk-container">
            <p>–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–π –∫–∞–±–∏–Ω–µ—Ç –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π —à–∫–æ–ª—ã</p>
        </div>
    </footer>
    {% block footer_scripts %}
    <script>
        function shutdownApplication() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?')) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
                UIkit.notification({
                    message: '–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä...',
                    status: 'primary',
                    timeout: 2000
                });

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫—É —Å–µ—Ä–≤–µ—Ä–∞
                fetch('/shutdown', { method: 'POST' })
                    .then(response => {
                        if (response.ok) {
                            return response.text();
                        }
                        throw new Error('Network response was not ok');
                    })
                    .then(data => {
                        // –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                        UIkit.notification({
                            message: '–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –≠—Ç–æ –æ–∫–Ω–æ –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å.',
                            status: 'success',
                            timeout: 5000
                        });

                        // –ü—Ä–æ–±—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                        setTimeout(() => {
                            try {
                                window.close();
                            } catch (e) {
                                console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å, –∑–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ –≤—Ä—É—á–Ω—É—é');
                            }
                        }, 3000);
                    })
                    .catch(error => {
                        console.error('–û—à–∏–±–∫–∞:', error);
                        UIkit.notification({
                            message: '–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —ç—Ç–æ –æ–∫–Ω–æ/–≤–∫–ª–∞–¥–∫—É –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å',
                            status: 'success',
                            timeout: 30000
                        });
                    });
            }
        }
    </script>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <script>
        {% for category, message in messages %}
        UIkit.notification({
            message: '{{message|safe}}',
            status: '{{category}}',
            pos: 'top-right',
            timeout: 5000
        });
        {% endfor %}
    </script>
    {% endif %}
    {% endwith %}
    {% endblock %}
</body>

</html>